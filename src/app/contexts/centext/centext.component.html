<!-- <app-header></app-header> -->

<div class="container-fluid h-100">
  <app-sidebar2></app-sidebar2>
    <main class="col-md-12 ms-sm-auto col-lg-11 px-md-4 h-100"> 


      <div class="row row-cols-1 row-cols-md-4 g-4 mb-5 pt-5 pb-2 mb-3">
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                  <div class="row row-cols-1 row-cols-md-2 g-4">
                    <div class="col text-center"  ><i class="mdi mdi-table-of-contents text-primary  fa-3x"></i> </div>

                    <div class="col "  >
                      <h5 >Total Context </h5>
                      <h5 class="text-danger text-center">{{countcontext}}</h5>
                    </div>

                </div>
            </div>
            </div>
        </div>
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                  <div class="row row-cols-1 row-cols-md-2 g-4">
                    <div class="col text-center"  ><i class="mdi mdi-message-text-outline text-info  fa-3x"></i> </div>

                    <div class="col "  >
                      <h5 >Total Q/R</h5>
                      <h5 class="text-danger text-center">{{countcontextconvertation}}</h5>
                    </div>

                </div>
            </div>
            </div>
        </div>
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                  <div class="row row-cols-1 row-cols-md-2 g-4">
                    <div class="col text-center"  ><i class="mdi mdi-account-outline text-warning  fa-3x"></i> </div>

                    <div class="col "  >
                      <h5 >Total User</h5>
                      <h5 class="text-danger text-center">{{countclient}}</h5>
                    </div>

                </div>
            </div>
            </div>
        </div>
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                  <div class="row row-cols-1 row-cols-md-2 g-4">
                    <div class="col text-center"  ><i class="mdi mdi-table-of-contents text-success  fa-3x"></i> </div>

                    <div class="col "  >
                      <h5 >Total User</h5>
                      <h5 class="text-danger text-center">{{countclient}}</h5>
                    </div>

                </div>
                </div>
            </div>
        </div>
    </div>


     <div class="row row-cols-1 row-cols-md-2 g-4 mb-5 pt-5 pb-2 mb-3">
       <div class="col"  >




        <div class="card  shadow h-100"  >
          <div class="card-header">
              Context
          </div>
         <div class="card-body">

           <div class="container-fluid h-50">
             <div class="row justify-content-center h-100">
               
               <div class="chat">
                   <div class="card-header msg_head">
                     <div class="d-flex bd-highlight">
                       <div class="img_cont">
                         <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img">
                         <span class="online_icon"></span>
                       </div>
                       <div class="user_info">
                         <span>Chat with {{currentmodel}}</span>
                         <p>1767 Messages</p>
                       </div>
                       <div class="video_cam">
                         <!-- <span><i class="fas fa-video"></i></span>
                         <span><i class="fas fa-phone"></i></span> -->
                         <span>
                          <form class="d-flex">
                            <select class="form-select me-2" [(ngModel)]="currentmodel" name="currentmodel" (change)="selectModel($event)">
                              <option  value="bert" selected>
                                Bert
                              </option>
                              <option  value="GPT3">
                                GPT3
                              </option>
                              <option  value="wikipedia">
                                wikipedia
                              </option>
                            </select>
                          </form>
                        </span>
                       </div>
                     </div>
                     
                     <span id="action_menu_btn"><i class="fas fa-ellipsis-v" id="dropdownMenu"></i></span>
                     <div class="action_menu">
                       
                     </div>
                   
                   </div>
                   <div class="card-body msg_card_body" >
                     
<!-- 
                     <input type="file" ng2FileSelect [uploader]="uploader">
                     <button (click)="uploader.uploadAll()">Upload </button> -->

                 <!-------------------------------------------------------------------->
                 <div *ngFor="let msg of visiteur_convertationlist">
                   <div ng-If="msg.photo==null"><!--debut ng if photo is valid-->
                     <div class="d-flex justify-content-end mb-4">
                       <div class="msg_cotainer_send">
                         {{msg.question}}
                         
                         <img ng-if="msg.photo!=null" src="{{msg.photo}}" alt="{{msg.photo}}" width="200"/> 
                         <span class="msg_time_send" style="color:rgb(20, 20, 32)">{{msg.entry_date}}</span>
                       </div>
                       <div class="img_cont_msg">
                     <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img_msg">
                       </div>
                     </div>
                     <div class="d-flex justify-content-start mb-4">
                       <div class="img_cont_msg">
                         <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img_msg">
                       </div>
                       <div class="msg_cotainer">
                          {{msg.response}}
                         <span class="msg_time_send" style="color:rgb(20, 20, 32)">{{msg.entry_date}}</span>
                       </div>
                     </div>
                     </div><!--fin ng if-->

                    
                   </div>
    <!-------------------------------------------------------------------->





                   </div>
                   <div class="card-footer">
                     <div class="input-group">
                       <!-- <div class="input-group-append"> -->
                         <span class="input-group-text attach_btn" *ngIf="listening$ | async; else mic" (click)="stop()" ><i class="mdi mdi-microphone" style="color:rgb(243, 42, 59)"></i></span><!--*ngIf="listening$ | async; else mic" (click)="stop()" -->
                         
                         <ng-template #mic>
                           <span class="input-group-text attach_btn" (click)="start()" ><i class="mdi mdi-microphone" style="color:rgb(72, 90, 255)" ></i></span><!--(click)="start()"-->
                         </ng-template>

                         <!--test upload-->
                         
                         
                           <!-- <label class="input-group-text image_btn" for="upload_file"  >
                            

                               <i  class="mdi mdi-camera" for="upload_file"  style="cursor: pointer;"></i> 
                             
                           <input type="file" name="image" id="upload_file" (change)="onChargeimage($event)"  style="display :none;visibility:none;" accept="image/x-png,image/gif,image/jpeg">            

                           
                           </label>   -->
                           
                         <!--end test upload-->
                         


                         <!-- <span class="input-group-text image_btn">
                           
                             <label for="file-input">
                               <i class="mdi mdi-camera"  (click)="uploader.uploadAll()"></i>
                             </label>
                         
                             <input type="file" id="file-input" ng2FileSelect [uploader]="uploader" style="display :none;visibility:none;" >
                           </span>
                          -->
                          
                         <!-- </div> -->


                         
                    

                       <input type="text" class="form-control type_msg" name="question"  [(ngModel)]="question" (keydown.enter)="GetMsgResponseAPI()"  placeholder="Type your message..."  value="{{transcript$ | async}}" > <!--name="msg" [(ngModel)]="msg"   (keydown.enter)="GetMsgResponseApi()"   value="{{transcript$ | async}}"-->
                       <!-- <div class="input-group-append"> -->
                         <span class="input-group-text send_btn" (click)="GetMsgResponseAPI()" ><i class="mdi mdi-send"  ></i></span> <!--click()="sendmsg()"   (click)="GetMsgResponseApi()"-->
                       <!-- </div> -->
                     </div>
                   </div>
                 </div>
               </div>
             </div>
           </div>
         </div>



         <!-- <div class="card  shadow h-100"  >
             <div class="card-header">
                 Context
             </div>
            <div class="card-body">



              <div class="container-fluid h-50">
                <div class="row justify-content-center h-100">
                  <div class=" chat">
                  
                      <div class="card-header msg_head">
                        <div class="d-flex bd-highlight">
                          <div class="img_cont">
                            <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img">
                            <span class="online_icon"></span>
                            
                          </div>
                          <div class="user_info">
                            <span>Chat with jassa</span>
                            <p>1767 Messages</p>
                          </div>
                          <div class="video_cam">
                            <span><i class="fas fa-video"></i></span>
                            <span><i class="fas fa-phone"></i></span>
                          </div>
                        </div>
                        <span id="action_menu_btn"><i class="fas fa-ellipsis-v"></i></span>
                        <div class="action_menu">
                          <ul>
                            <li><i class="fas fa-user-circle"></i> View profile</li>
                            <li><i class="fas fa-users"></i> Add to close friends</li>
                            <li><i class="fas fa-plus"></i> Add to group</li>
                            <li><i class="fas fa-ban"></i> Block</li>
                          </ul>
                        </div>
                      </div>
                      <div class="card-body msg_card_body">
                        
                      <div *ngFor="let msg of visiteur_convertationlist">
                        <div ng-If="msg.photo==null">
                          <div class="d-flex justify-content-end mb-4">
                            <div class="msg_cotainer_send">
                              {{msg.question}}
                              
                              <img ng-if="msg.photo!=null" src="{{msg.photo}}" alt="{{msg.photo}}" width="200"/> 
                              <span class="msg_time_send" style="color:rgb(20, 20, 32)">{{msg.entry_date}}</span>
                            </div>
                            <div class="img_cont_msg">
                          <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img_msg">
                            </div>
                          </div>
                          <div class="d-flex justify-content-start mb-4">
                            <div class="img_cont_msg">
                              <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img_msg">
                            </div>
                            <div class="msg_cotainer">
                               {{msg.response}}
                              <span class="msg_time_send" style="color:rgb(20, 20, 32)">{{msg.entry_date}}</span>
                            </div>
                          </div>
                          </div>
  
                         
                        </div>
                    </div>
                      <div class="card-footer">
                        <div class="input-group">
                          <div class="input-group-append">
                            <span class="input-group-text attach_btn"><i class="mdi mdi-paperclip"></i></span>
                          </div>
                          <input name="question"  [(ngModel)]="question" class="form-control type_msg" placeholder="Type your message..." (keydown.enter)="sendmsg()">
                          <div class="input-group-append">
                            <span class="input-group-text send_btn" (click)="sendmsg()"><i class="mdi mdi-send"></i></span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div> -->
         </div>
       

        <div class="col"  >
            <div class="card  shadow h-100"  >

              <div class="card-header">
                Context charset
              </div>
              <div class="card-body">

                <canvas baseChart 
                  [datasets]="lineChartData" 
                  [labels]="lineChartLabels" 
                  [options]="lineChartOptions"
                  [colors]="lineChartColors" 
                  [legend]="lineChartLegend" 
                  [chartType]="lineChartType" 
                  [plugins]="lineChartPlugins">
              </canvas>


              </div>


              <div class="card-header">
                Context charset
              </div>
            <div class="card-body ">
              <div class="col-md-3">
                <select class="form-select" [(ngModel)]="top" name="top" (change)="selectLimit($event)">
                    <option  [value]= 3  >
                        3
                    </option>
                    <option  [value]= 5 >
                        5
                    </option>
                    <option [value]= 10  >
                        10
                    </option>
                    
                </select>
            </div>

              <canvas baseChart 
                [data]="pieChartData" 
                [labels]="pieChartLabels" 
                [chartType]="pieChartType"
                [options]="pieChartOptions"
                [colors]="pieChartColors"

              >
              </canvas>
            </div>
              

            </div>

         </div>
      </div>


      <div class="row ">
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                    <h5 >Context List</h5>
                      <div class="card-body">
                        <table id="example" class="table table-striped" >
                            <thead>
                              <tr>
                                <th scope="col">Text</th>
                                <th scope="col">Titre</th>
                                <th scope="col">Entry date</th>
                                <th scope="col">Status</th>
                                <th scope="col">Type</th>
                               
                              </tr>
                            </thead>
                            <tbody>
                              <tr *ngFor="let collumn of contextforalluserlist | paginate: { itemsPerPage: 10, currentPage: p }">
                                <td scope="row">{{collumn.text}}</td>
                                <td scope="row">{{collumn.title}}</td>
                                <td>{{collumn.entry_date}}</td>
                                
                                <td>
                                    <span class="badge bg-success">Valide</span>
                                    <!-- <span *ngIf="context.status == '0'" class="badge badge-danger">Deleted</span>  -->

                                </td>
                                <td>
                                  <span class="badge bg-success"><i class="mdi mdi-earth"></i></span>
                                  <!-- <span   class="badge badge-danger"><i class="mdi mdi-earth-off"></i></span>  -->
                                </td>

                                
                                <td>
                                  <span  type="button"  (click)="ModalShowQuestionAnserwerOpen(showQA);getQR(collumn.id_context)" class="badge rounded-pill bg-info" ><a type="button"  ><i class="mdi mdi-telescope" ></i> </a></span> 
                                  
                                </td>
                                <!-- <td><button type="button" class="btn btn-primary" (click)="modalUpdateOpen(modalUpdateContext,context.id_context,context.text)">Update</button></td> -->
                              </tr>
                            
                            </tbody>
                          </table>
                          <div class="pagination">
                            <pagination-controls (pageChange)="p = $event"></pagination-controls>
                          </div>
                    </div>
                  </div>
                  <p></p>
              </div>
          </div>
         
      </div>
    


    


       </main> 
</div>



<!-- <ng-template #showQA >
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Ajouter nouveau Question & Réponse</h4>
     <button type="button" class="close" aria-label="Close" (click)="closeDialog()" >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

  <div class="modal-body">
      <div class="card-body table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <th scope="col"> Question </th>
            <th scope="col"> Answer </th>
           
          </tr>
        </thead>
        <tbody>
          <tr  *ngFor="let collumn of context_QRlist">
            <td style="overflow-wrap: break-word;" scope="row">{{collumn.question}}</td>
            <td style="overflow-wrap: break-word;" scope="row">{{collumn.responce}}</td>
          </tr>
        
        </tbody>
      </table>
    </div>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-outline-dark"  >Save</button>  
  </div>
</ng-template> -->


<ng-template #showQA>
  
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">List des Questoin et Reponse</h4>
    <button type="button" class="close" aria-label="Close" (click)="closeDialog()" >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

  <div class="modal-body modal-lg">
<div>
    <h5 >Context List</h5>
        <div class="card-body table-responsive">
          <table  class="table table-striped">
              <thead>
                <tr>
                  <th scope="col"> Question </th>
                  <th scope="col"> Answer </th>
                 
                </tr>
              </thead>
              <tbody>
                <tr  *ngFor="let collumn1 of context_QRlist | paginate: {id: 'versionPagination1' , itemsPerPage: 10, currentPage: p1 }">
                  <td style="overflow-wrap: break-word;" scope="row">{{collumn1.question}}</td>
                  <td style="overflow-wrap: break-word;" scope="row">{{collumn1.response}}</td>
                </tr>
              
              </tbody>
            </table>
            
            <div class="pagination">
              <pagination-controls id="versionPagination1" (pageChange)="p1 = $event"></pagination-controls>
            </div>
          
          </div>
          </div> 
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn btn-danger"   (click)="closeDialog()" >Close</button>
  </div>
</ng-template>